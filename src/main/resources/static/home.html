<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Home</title>
    <style>
        table {
            font-family: arial, sans-serif;
            border-collapse: collapse;
            width: 100%;
        }

        td, th {
            border: 1px solid #dddddd;
            text-align: left;
            padding: 8px;
        }

        tr:nth-child(even) {
            background-color: #dddddd;
        }
    </style>
</head>
<body>
<h1>Home</h1>
<div id="userInfo">
    <h2>My User Info</h2>
</div>
<br>
<input type="button" value="View Currencies" onclick="function clickViewCurrenciesButton() {
window.location.replace(`/viewCurrencies.html`)
}
clickViewCurrenciesButton()"/><br>
<br>
<input type="button" value="Sell Currency" onclick="function clickSellCurrencyButton() {
window.location.replace(`/transactionSell.html`)
}
clickSellCurrencyButton()"/><br>
<br>
<input type="button" value="Buy Currency" onclick="function clickBuyCurrencyButton() {
// window.location.replace(`/transactionBuy.html`)
}
clickBuyCurrencyButton()"/><br>
<div id="myTx">
    <h2>My Transactions</h2>
</div>

<script type="text/javascript">
<!--    UserInfo-->
    const user = JSON.parse(sessionStorage.getItem("user"));
    if(user !== null) {
        console.log(`user = ${user}`);
        const userInfoDiv = document.getElementById("userInfo");
        userInfoDiv.innerHTML += '<ul>';
        userInfoDiv.innerHTML += `<br>User ID: ${user.userID}`;
        userInfoDiv.innerHTML += `<br>Username: ${user.username}`;
        userInfoDiv.innerHTML += `<br>First Name: ${user.firstName}`;
        userInfoDiv.innerHTML += `<br>Last Name: ${user.lastName}`;
        userInfoDiv.innerHTML += `<br>Email Address: ${user.email}`;
        userInfoDiv.innerHTML += `<br>Country: ${user.country}`;
        userInfoDiv.innerHTML += '</ul>';
    }else{
        window.location.replace(`/login.html`);
    }
// My Tx
    fetch('/transaction/user/' + user.userID.toString(), {method: 'GET', headers: {},})
    .then(res => res.json())
        .then(res => {
        let html = '<table>';
        html += '<tr>';
        html += '<th>Transaction ID</th>';
        html += '<th>Seller ID</th>';
        html += '<th>Buyer ID</th>';
        html += '<th>From</th>';
        html += '<th>To</th>';
        html += '<th>Rate</th>';
        html += '<th>Amount</th>';
        html += '<th>Price</th>';
        html += '<th>Expiry Date</th>';
        html += '<th>Finished</th>';
        html += '</tr>';

        res.forEach(elem => {
            html += '<tr>';
            html += '<td>' + elem.transactionID +'</td>';
            html += '<td>' + elem.sellerID +'</td>';
            html += '<td>' + elem.buyerID +'</td>';
            html += '<td>' + elem.currencyCodeFrom +'</td>';
            html += '<td>' + elem.currencyCodeTo +'</td>';
            html += '<td>' + elem.rate +'</td>';
            html += '<td>' + elem.amount +'</td>';
            html += '<td>' + elem.price +'</td>';
            html += '<td>' + elem.expiryDate +'</td>';
            html += '<td>' + elem.approved +'</td>';
            html += '</tr>';
        });
        html += '</table>';
        document.getElementById("myTx").innerHTML += html;
        return res;
        }).catch(error => {console.error(error);})

</script>

</body>
</html>